var m,l,P,T,s=function(t,e){return{name:t,value:e===void 0?-1:e,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},h=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){if(t==="first-input"&&!("PerformanceEventTiming"in self))return;var i=new PerformanceObserver(function(r){return r.getEntries().map(e)});return i.observe({type:t,buffered:!0}),i}}catch{}},y=function(t,e){var i=function r(n){n.type!=="pagehide"&&document.visibilityState!=="hidden"||(t(n),e&&(removeEventListener("visibilitychange",r,!0),removeEventListener("pagehide",r,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},g=function(t){addEventListener("pageshow",function(e){e.persisted&&t(e)},!0)},v=function(t,e,i){var r;return function(n){e.value>=0&&(n||i)&&(e.delta=e.value-(r||0),(e.delta||r===void 0)&&(r=e.value,t(e)))}},d=-1,w=function(){return document.visibilityState==="hidden"?0:1/0},F=function(){y(function(t){var e=t.timeStamp;d=e},!0)},S=function(){return d<0&&(d=w(),F(),g(function(){setTimeout(function(){d=w(),F()},0)})),{get firstHiddenTime(){return d}}},H=function(t,e){var i,r=S(),n=s("FCP"),o=function(c){c.name==="first-contentful-paint"&&(u&&u.disconnect(),c.startTime<r.firstHiddenTime&&(n.value=c.startTime,n.entries.push(c),i(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],u=a?null:h("paint",o);(a||u)&&(i=v(t,n,e),a&&o(a),g(function(c){n=s("FCP"),i=v(t,n,e),requestAnimationFrame(function(){requestAnimationFrame(function(){n.value=performance.now()-c.timeStamp,i(!0)})})}))},b=!1,E=-1,q=function(t,e){b||(H(function(f){E=f.value}),b=!0);var i,r=function(f){E>-1&&t(f)},n=s("CLS",0),o=0,a=[],u=function(f){if(!f.hadRecentInput){var A=a[0],B=a[a.length-1];o&&f.startTime-B.startTime<1e3&&f.startTime-A.startTime<5e3?(o+=f.value,a.push(f)):(o=f.value,a=[f]),o>n.value&&(n.value=o,n.entries=a,i())}},c=h("layout-shift",u);c&&(i=v(r,n,e),y(function(){c.takeRecords().map(u),i(!0)}),g(function(){o=0,E=-1,n=s("CLS",0),i=v(r,n,e)}))},p={passive:!0,capture:!0},I=new Date,C=function(t,e){m||(m=e,l=t,P=new Date,k(removeEventListener),D())},D=function(){if(l>=0&&l<P-I){var t={entryType:"first-input",name:m.type,target:m.target,cancelable:m.cancelable,startTime:m.timeStamp,processingStart:m.timeStamp+l};T.forEach(function(e){e(t)}),T=[]}},R=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;t.type=="pointerdown"?function(i,r){var n=function(){C(i,r),a()},o=function(){a()},a=function(){removeEventListener("pointerup",n,p),removeEventListener("pointercancel",o,p)};addEventListener("pointerup",n,p),addEventListener("pointercancel",o,p)}(e,t):C(e,t)}},k=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,R,p)})},M=function(t,e){var i,r=S(),n=s("FID"),o=function(u){u.startTime<r.firstHiddenTime&&(n.value=u.processingStart-u.startTime,n.entries.push(u),i(!0))},a=h("first-input",o);i=v(t,n,e),a&&y(function(){a.takeRecords().map(o),a.disconnect()},!0),a&&g(function(){var u;n=s("FID"),i=v(t,n,e),T=[],l=-1,m=null,k(addEventListener),u=o,T.push(u),D()})},L={},N=function(t,e){var i,r=S(),n=s("LCP"),o=function(c){var f=c.startTime;f<r.firstHiddenTime&&(n.value=f,n.entries.push(c),i())},a=h("largest-contentful-paint",o);if(a){i=v(t,n,e);var u=function(){L[n.id]||(a.takeRecords().map(o),a.disconnect(),L[n.id]=!0,i(!0))};["keydown","click"].forEach(function(c){addEventListener(c,u,{once:!0,capture:!0})}),y(u,!0),g(function(c){n=s("LCP"),i=v(t,n,e),requestAnimationFrame(function(){requestAnimationFrame(function(){n.value=performance.now()-c.timeStamp,L[n.id]=!0,i(!0)})})})}},O=function(t){var e,i=s("TTFB");e=function(){try{var r=performance.getEntriesByType("navigation")[0]||function(){var n=performance.timing,o={entryType:"navigation",startTime:0};for(var a in n)a!=="navigationStart"&&a!=="toJSON"&&(o[a]=Math.max(n[a]-n.navigationStart,0));return o}();if(i.value=i.delta=r.responseStart,i.value<0||i.value>performance.now())return;i.entries=[r],t(i)}catch{}},document.readyState==="complete"?setTimeout(e,0):addEventListener("load",function(){return setTimeout(e,0)})};export{q as getCLS,H as getFCP,M as getFID,N as getLCP,O as getTTFB};
